# Sampling Explorer: How To Read The Plots

This page shows **samples** (MD evaluations and Potts-generated samples) and **derived analyses**.

Important: a `samples/<sample_id>/sample.npz` is intentionally minimal (labels + optional invalid mask). Almost everything you plot here is computed by running **Run analysis**, which writes results under:

`clusters/<cluster_id>/analyses/`

## What Is A “Sample” Here?

Each frame is represented as a discrete vector `s_t` of length `N` (one entry per residue/feature).

- **MD samples**: labels obtained by assigning MD frames to the cluster states.
- **Potts samples**: labels generated by sampling a fitted Potts model (Gibbs / SA).
- **Lambda sweeps**: a correlated series of Gibbs samples from interpolated endpoint models (`λ` grid). These are listed separately to avoid mixing them with standard Gibbs/SA runs. The dedicated analysis/plots live on the **Lambda Sweep** page.

## Model Selection Matters (Edges + Energies)

Clusters often do **not** persist edges (contacts), so edge-based metrics must use an **edge set** coming from a Potts model.

When you pick a Potts model in the sidebar, the UI uses that model’s edges for:

- edge JS (pairwise distribution divergence)
- energy histograms (energies computed under that model)
- sample filtering (optionally showing only samples generated from that model)

If you change the model, edge plots and energies can change even if samples are the same.

## MD vs Sample Panel (JS Metrics)

This panel compares **one MD sample** against **one Potts sample**.

- **Node JS**: per-residue Jensen–Shannon divergence between 1D marginals `p_i(a)` of MD vs sample.
- **Edge JS**: per-edge Jensen–Shannon divergence between pairwise marginals `p_{ij}(a,b)` along the selected model’s edges.

How to interpret:

- **Low JS** means the sample reproduces the MD distribution on that residue/edge.
- **High JS** highlights where the sample differs most from MD.

“Top residues/edges” tables are simply the largest JS values.

## Energy Panel

Energies are computed as `E(s_t)` under the selected Potts model.

Interpretation:

- Different samples can have different energy ranges.
- If a Potts sampler is working “as intended”, Potts-generated samples often sit in a similar energy band as the MD ensembles the model was trained to represent (but this is not guaranteed).

## Label Modes / Invalid Mask

- **MD label mode**: “assigned” vs “halo” controls which MD labels are compared.
- **Keep invalid SA**: if disabled, frames marked invalid by SA constraints are excluded from comparisons/plots.
